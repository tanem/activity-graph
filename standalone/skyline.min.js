(function(){function require(name){var module=require.modules[name];if(!module)throw new Error('failed to require "'+name+'"');if(!("exports"in module)&&typeof module.definition==="function"){module.client=module.component=true;module.definition.call(this,module.exports={},module);delete module.definition}return module.exports}require.modules={};require.register=function(name,definition){require.modules[name]={definition:definition}};require.define=function(name,exports){require.modules[name]={exports:exports}};require.register("component~raf@1.1.3",function(exports,module){exports=module.exports=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||fallback;var prev=(new Date).getTime();function fallback(fn){var curr=(new Date).getTime();var ms=Math.max(0,16-(curr-prev));var req=setTimeout(fn,ms);prev=curr;return req}var cancel=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout;exports.cancel=function(id){cancel.call(window,id)}});require.register("kenany~isinteger@1.0.4",function(exports,module){module.exports=function(x){return x===Math.round(x)}});require.register("component~bind@0.0.1",function(exports,module){var slice=[].slice;module.exports=function(obj,fn){if("string"==typeof fn)fn=obj[fn];if("function"!=typeof fn)throw new Error("bind() requires a function");var args=[].slice.call(arguments,2);return function(){return fn.apply(obj,args.concat(slice.call(arguments)))}}});require.register("component~domify@1.2.2",function(exports,module){module.exports=parse;var map={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:[0,"",""]};map.td=map.th=[3,"<table><tbody><tr>","</tr></tbody></table>"];map.option=map.optgroup=[1,'<select multiple="multiple">',"</select>"];map.thead=map.tbody=map.colgroup=map.caption=map.tfoot=[1,"<table>","</table>"];map.text=map.circle=map.ellipse=map.line=map.path=map.polygon=map.polyline=map.rect=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];function parse(html){if("string"!=typeof html)throw new TypeError("String expected");var m=/<([\w:]+)/.exec(html);if(!m)return document.createTextNode(html);html=html.replace(/^\s+|\s+$/g,"");var tag=m[1];if(tag=="body"){var el=document.createElement("html");el.innerHTML=html;return el.removeChild(el.lastChild)}var wrap=map[tag]||map._default;var depth=wrap[0];var prefix=wrap[1];var suffix=wrap[2];var el=document.createElement("div");el.innerHTML=prefix+html+suffix;while(depth--)el=el.lastChild;if(el.firstChild==el.lastChild){return el.removeChild(el.firstChild)}var fragment=document.createDocumentFragment();while(el.firstChild){fragment.appendChild(el.removeChild(el.firstChild))}return fragment}});require.register("component~autoscale-canvas@0.0.3",function(exports,module){module.exports=function(canvas){var ctx=canvas.getContext("2d");var ratio=window.devicePixelRatio||1;if(1!=ratio){canvas.style.width=canvas.width+"px";canvas.style.height=canvas.height+"px";canvas.width*=ratio;canvas.height*=ratio;ctx.scale(ratio,ratio)}return canvas}});require.register("skyline",function(exports,module){"use strict";var raf=require("component~raf@1.1.3");var bind=require("component~bind@0.0.1");var domify=require("component~domify@1.2.2");var template=require("skyline/template.html");var autoscale=require("component~autoscale-canvas@0.0.3");module.exports=Skyline;function Skyline(){this._barSpacing=2;this._barWidth=4;this._gutter=40;this._width=780;this._height=280;this._backgroundBarColour="#ddd";this._historyBarColour="#00cccc";this._axesFont="13px sans-serif";this._frameRate=20;this.buffer=0;this.el=domify(template);this.animate=bind(this,"animate");this.backgroundBarCb=bind(this,"backgroundBarCb");this.historyBarCb=bind(this,"historyBarCb")}Skyline.prototype.barSpacing=function(barSpacing){this._barSpacing=barSpacing;return this};Skyline.prototype.barWidth=function(barWidth){this._barWidth=barWidth;return this};Skyline.prototype.gutter=function(gutter){this._gutter=gutter;return this};Skyline.prototype.width=function(width){this._width=width;return this};Skyline.prototype.height=function(height){this._height=height;return this};Skyline.prototype.backgroundBarColour=function(backgroundBarColour){this._backgroundBarColour=backgroundBarColour;return this};Skyline.prototype.historyBarColour=function(historyBarColour){this._historyBarColour=historyBarColour;return this};Skyline.prototype.axesFont=function(axesFont){this._axesFont=axesFont;return this};Skyline.prototype.frameRate=function(frameRate){this._frameRate=frameRate;return this};Skyline.prototype.createHistoryArray=function(){this.history=[];var i=0,j=this._width/(this._barSpacing+this._barWidth);for(;i<j;i++)this.history[i]=0};Skyline.prototype.drawBackground=function(){this.drawBars(this.backgroundBarCb)};Skyline.prototype.backgroundBarCb=function(xPos){this.bgCtx.fillRect(xPos,this._gutter,this._barWidth,this._height-this._gutter*2)};Skyline.prototype.initialiseBackgroundCanvas=function(){var canvas=this.el.querySelector(".skyline-background");canvas.width=this._width;canvas.height=this._height;autoscale(canvas);this.bgCtx=canvas.getContext("2d");this.bgCtx.fillStyle=this._backgroundBarColour};Skyline.prototype.initialiseHistoryCanvas=function(){var canvas=this.el.querySelector(".skyline-history");canvas.width=this._width;canvas.height=this._height;autoscale(canvas);this.historyCtx=canvas.getContext("2d");this.historyCtx.fillStyle=this._historyBarColour};Skyline.prototype.start=function(){this.createHistoryArray();this.initialiseBackgroundCanvas();this.initialiseHistoryCanvas();this.drawBackground();this.animateInterval=1e3/this._frameRate;this.rafId=raf(this.animate)};Skyline.prototype.animate=function(){this.rafId=raf(this.animate);var now=Date.now();this.animateStart=this.animateStart||now;var animateDelta=now-this.animateStart;if(animateDelta>this.animateInterval){this.animateStart=now-animateDelta%this.animateInterval;this.processHistoryFrame()}};Skyline.prototype.processHistoryFrame=function(){for(var i=0,j=this.history.length-1;i<j;i++){this.history[i]=this.history[i+1]}this.history[this.history.length-1]=this.buffer;this.drawHistory();this.buffer=0};Skyline.prototype.drawHistory=function(){var maxHits=Math.max.apply(null,this.history);if(!this.maxAxesPoint||maxHits>=this.maxAxesPoint)this.drawAxes(maxHits);this.historyMultiplier=(this._height-this._gutter*2)/this.maxAxesPoint;this.historyCtx.clearRect(0,0,this._width,this._height);this.historyStartIndex=this.history.length-1;this.drawBars(this.historyBarCb)};Skyline.prototype.historyBarCb=function(xPos){var hits=this.history[this.historyStartIndex--]*this.historyMultiplier;this.historyCtx.fillRect(xPos,this._height-this._gutter-hits,this._barWidth,hits)};Skyline.prototype.drawBars=function(cb){var xPos=this._width-this._gutter-this._barWidth,start=this._gutter;for(;xPos>=start;xPos-=this._barSpacing+this._barWidth)cb(xPos)};Skyline.prototype.drawAxes=function(maxHits){maxHits=maxHits||1;var points=[0,maxHits,maxHits*2,maxHits*3,maxHits*4];this.maxAxesPoint=points[4];this.bgCtx.font=this._axesFont;this.drawLeftYAxis(points);this.drawRightYAxis(points)};Skyline.prototype.drawLeftYAxis=function(points){var xPos=this._gutter-5;var drawingAreaHeight=this._height-this._gutter*2;this.bgCtx.clearRect(0,0,xPos,this._height);this.bgCtx.textAlign="right";this.bgCtx.textBaseline="middle";this.bgCtx.fillText(points[4],xPos,this._gutter);this.bgCtx.fillText(points[3],xPos,this._gutter+drawingAreaHeight/4);this.bgCtx.fillText(points[2],xPos,this._gutter+drawingAreaHeight/2);this.bgCtx.fillText(points[1],xPos,this._height-this._gutter-drawingAreaHeight/4);this.bgCtx.fillText(points[0],xPos,this._height-this._gutter)};Skyline.prototype.drawRightYAxis=function(points){var xPos=this._width-this._gutter+5;var drawingAreaHeight=this._height-this._gutter*2;this.bgCtx.clearRect(xPos,0,this._width-xPos,this._height);this.bgCtx.textAlign="left";this.bgCtx.textBaseline="middle";this.bgCtx.fillText(points[4],xPos,this._gutter);this.bgCtx.fillText(points[3],xPos,this._gutter+drawingAreaHeight/4);this.bgCtx.fillText(points[2],xPos,this._gutter+drawingAreaHeight/2);this.bgCtx.fillText(points[1],xPos,this._height-this._gutter-drawingAreaHeight/4);this.bgCtx.fillText(points[0],xPos,this._height-this._gutter)};Skyline.prototype.addHit=function(){this.buffer++}});require.define("skyline/template.html",'<div class="skyline">\n  <canvas class="skyline-background"></canvas>\n  <canvas class="skyline-history"></canvas>\n</div>');if(typeof exports=="object"){module.exports=require("skyline")}else if(typeof define=="function"&&define.amd){define([],function(){return require("skyline")})}else{this["Skyline"]=require("skyline")}})();